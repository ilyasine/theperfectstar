(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(t){var o=function(t,o){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,o||"default");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===o?String:Number)(t)}(t,"string");return"symbol"==e(o)?o:o+""}var r,n;window.uotcGroupQuizReport=window.uotcGroupQuizReport||{},r=jQuery,n=function(){return e=function e(t,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.API=uotcGroupQuizReport,this.$parent=t,this.$elements={},this.tableConfig=o,this.i18n=this.API.i18n,this.labelLoadingClass=this.i18n.cssSelectors.labelLoading,this.tableLoadingSelector="."+this.i18n.cssSelectors.tableLoading,this.table=null,this.scoreType=o.scoreType,this.action="init",this.getElements(),this.filters()},o=[{key:"getElements",value:function(){this.$elements={groupQuizReport:r("table.uo-group-quiz-report-table",this.$parent),quizSelectLabel:r(".uo-group-quiz-report-quizzes-label",this.$parent),filter:{all:r(".change-group-management-form",this.$parent),group:r(".uo-group-quiz-report-group",this.$parent),quiz:r(".uo-group-quiz-report-quizzes",this.$parent)}}}},{key:"filters",value:function(){var e=this;this.$elements.filter.all.on("change",(function(){void 0!==e.$elements.groupQuizReport&&e.clearTable()})),this.$elements.filter.group.on("change",(function(){e.$elements.filter.quiz.val(""),e.action="get-quizzes",""!==e.$elements.filter.group.val()?(e.$elements.quizSelectLabel.addClass(e.labelLoadingClass),e.getData()):(e.clearTable(),e.updateQuizSelect([{value:"",text:e.i18n.noQuizResults}]))})),this.$elements.filter.quiz.on("change",(function(){e.action="update-table",""!==e.$elements.filter.quiz.val()?(e.addLoaderAnimation(),e.getData()):e.clearTable()}))}},{key:"createDataTable",value:function(e){var t=this,o=t.i18n,n=t.tableConfig,a=n.columns,s=t.API.columns,i=[],u=0;for(var l in s){var p={targets:u,data:l,title:s[l],visible:"user_name"!==l&&a.includes(l)};i.push(p),u++}var c=[],d=i.findIndex((function(e){return e.title==n.orderBy}))||i.findIndex((function(e){return"quiz_date"==e.data}));-1!==d&&(c=[[d,n.order]]);var g=o.table_language,f={exportOptions:{columns:function(e,o,r){return t.table.column(e).visible()},format:{body:function(e,t,o,r){return e.replace(/<span class="ulg-hidden-data"[^>]*>.*?<\/span>/g,"")}}}};this.table=this.$elements.groupQuizReport.DataTable({initComplete:function(e,n){var a=e.oInstance.api(),s=r('<div id="'.concat(e.sInstance,'-filter-columns" class="dataTables-filter-columns">\n\t\t\t\t\t<input class="dataTables-filter-columns-field" id="').concat(e.sInstance,'-filter-columns-field" type="checkbox">\n\t\t\t\t\t<div class="dataTables-filter-columns__toggle">\n\t\t\t\t\t\t<label for="').concat(e.sInstance,'-filter-columns-field" data-label-enable="').concat(o.customColumnLabels.customizeColumns,'" data-label-disable="').concat(o.customColumnLabels.hideCustomizeColumns,'"></label>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="dataTables-filter-columns__fields"></div>\n\t\t\t\t</div>'));null!==e.oSavedState?r.each(e.oSavedState.columns,(function(o,r){var n=e.aoColumns[o].sTitle;s.find(".dataTables-filter-columns__fields").append(t.addColumnCheckbox(n,o,r.visible,a))})):r.each(e.aoColumns,(function(o,r){var n=e.aoColumns[o].sTitle;s.find(".dataTables-filter-columns__fields").append(t.addColumnCheckbox(n,o,r.bVisible,a))})),r(s).insertBefore(t.$elements.groupQuizReport),a.on("search.dt length.dt page.dt",(function(){a.columns.adjust().responsive.recalc()}))},columns:i,data:e,dom:'<"uotc-datatable-header"lB>frt<"uotc-datatable-footer"pi>',buttons:[r.extend(!0,{},f,{extend:"csv",text:o.buttons.exportCSV}),r.extend(!0,{},f,{extend:"excelHtml5",text:o.buttons.exportExcel})],language:g,aLengthMenu:[[15,30,60,-1],[15,30,60,o.all]],order:c,iDisplayLength:30,columnDefs:[{targets:5,orderable:!1,searchable:!1}]})}},{key:"addColumnCheckbox",value:function(e,t,o,n){var a=r("<input />",{type:"checkbox",id:"dt_"+t,value:t,checked:o});return a.on("change",(function(e){var t=r(this).attr("value"),o=r(this).is(":checked");n.columns().every((function(e){e==t&&n.column(e).visible(o)}))})),r("<label/>").append(a).append(e)}},{key:"clearTable",value:function(){if(null!==this.table)try{this.table.clear().draw().columns.adjust().responsive.recalc()}catch(e){console.warn(e)}}},{key:"emptyTableMessage",value:function(){}},{key:"populateDataTable",value:function(e){if(null===this.table)return this.createDataTable(e),void this.removeLoaderAnimation();this.clearTable(),this.table.rows.add(e),this.table.draw().columns.adjust().responsive.recalc(),0===e.length&&this.emptyTableMessage(),this.removeLoaderAnimation()}},{key:"updateQuizSelect",value:function(e){var t=this.$elements.filter.quiz;for(var o in t.html(""),1===e.length?""===e[0].value&&(t.prop("disabled",!0),r(t).addClass("uotc-report-select-filter-select--empty")):(t.prop("disabled",!1),r(t).removeClass("uotc-report-select-filter-select--empty")),e){var n=e[o],a=r("<option/>").attr({value:n.value}).text(n.text);t.append(a)}this.$elements.quizSelectLabel.removeClass(this.labelLoadingClass)}},{key:"getData",value:function(){var e=this,t={group_id:e.$elements.filter.group.val(),quiz_id:e.$elements.filter.quiz.val(),score_type:e.scoreType},o=e.action,n="get-quizzes"===o?"get-quiz-report-quiz-options":"get-quiz-report-data",a=e.API.root+n+"/";r.ajax({method:"POST",data:t,url:a,beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",e.API.nonce)},success:function(t){"get-quizzes"===o&&e.updateQuizSelect(t.options,""),"update-table"===o&&e.populateDataTable(t.results)},fail:function(t){console.log(t),e.removeLoaderAnimation()}})}},{key:"addLoaderAnimation",value:function(){r(this.$parent).append(this.API.loadingAnimation)}},{key:"removeLoaderAnimation",value:function(){r(this.tableLoadingSelector,this.$parent).remove()}}],o&&t(e.prototype,o),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,o,n}(),r(document).ready((function(){if("undefined"!=typeof uotcGroupQuizReport&&null!==uotcGroupQuizReport){var e=uotcGroupQuizReport.instances;if(Array.isArray(e)&&e.length>0)for(var t=e.length,o=0;o<t;o++){var a=e[o],s=r(".uo-group-quiz-report[data-instance="+a.instance+"]");s.length>0&&(uotcGroupQuizReport[a.instance]=new n(s,a))}}}))})(),(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(t){var o=function(t,o){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,o||"default");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===o?String:Number)(t)}(t,"string");return"symbol"==e(o)?o:o+""}var r,n;window.uotcTopicLessonReports=window.uotcTopicLessonReports||{},r=jQuery,n=function(){return e=function e(t,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$parent=t,this.$elements={},this.table=null,this.type=o,this.courseData=[],this.courseIDs=[],this.action="init",this.getElements(),this.getCourseData(),this.filters(),this.createDataTable()},o=[{key:"getElements",value:function(){this.$elements={stepReport:r("table.dataTable",this.$parent),filter:{all:r(".uotc-report__filters select",this.$parent),groupID:r(".uotc-report__select__group",this.$parent),courseID:r(".uotc-report__select__course",this.$parent),courseStepID:r(".uotc-report__select__course__step",this.$parent)}}}},{key:"getCourseData",value:function(){var e=this;r("> option",this.$elements.filter.courseID).each((function(){var t=""!==this.value?parseInt(this.value):"";""!==t&&e.courseIDs.push(t),e.courseData.push({id:t,text:this.text})}))}},{key:"filters",value:function(){var e=this;this.$elements.filter.all.on("change",(function(){void 0!==e.$elements.stepReport&&e.clearTable()})),this.$elements.filter.groupID.on("change",(function(){e.$elements.filter.courseID.val(""),e.$elements.filter.courseStepID.val(""),e.updateCourseStepSelect([],""),""!==e.$elements.filter.groupID.val()?(e.updateCourseSelect([],""),e.action="update-courses",e.getData()):(e.updateCourseSelect(e.courseIDs,""),e.clearTable())})),this.$elements.filter.courseID.on("change",(function(){e.$elements.filter.courseStepID.val(""),""!==e.$elements.filter.courseID.val()?(e.action="update-course-steps",e.getData()):(e.clearTable(),e.updateCourseStepSelect([],""))})),this.$elements.filter.courseStepID.on("change",(function(){e.action="update-table",""!==e.$elements.filter.courseStepID.val()?e.getData():e.clearTable()}))}},{key:"createDataTable",value:function(e){var t=this,o=[],n=uotcTopicLessonReports.i18n;for(var a in uotcTopicLessonReports.columns){var s={data:a,title:uotcTopicLessonReports.columns[a]};"step_status"===a&&(s.render=function(e,t,o){return 1===parseInt(e)?n.status.completed:n.status.incomplete}),o.push(s)}var i=n.table_language;i.search="",i.infoPostFix="",i.emptyTable=n.emptyTable.defaults[this.type];var u={exportOptions:{columns:function(e,o,r){return t.table.column(e).visible()},format:{body:function(e,t,o,r){return e.replace(/\<span\s(?:class\=\"uotc\-hidden\-data\")(.*)\<\/span\>/g,"")}}},filename:function(){var e="uo-"+t.type+"-report";return""!==t.$elements.filter.groupID.val()&&(e+="-group-"+r("option:selected",t.$elements.filter.groupID).text()),""!==t.$elements.filter.courseID.val()&&(e+="-course-"+r("option:selected",t.$elements.filter.courseID).text()),""!==t.$elements.filter.courseStepID.val()&&(e+="-"+t.type+"-"+r("option:selected",t.$elements.filter.courseStepID).text()),e+="-for-user-id-"+uotcTopicLessonReports.currentUser,(e+="-date-"+(new Date).toLocaleDateString("en-CA")).replace(/\s+/g,"-").toLowerCase()}};this.table=this.$elements.stepReport.DataTable({initComplete:function(e,o){var a=e.oInstance.api(),s=n.customColumnLabels,i=r('<div id="'.concat(e.sInstance,'-filter-columns" class="uotc-dataTables-filter-columns">\n                    <input class="uotc-dataTables-filter-columns-field" id="').concat(e.sInstance,'-filter-columns-field" type="checkbox">\n                    <div class="uotc-dataTables-filter-columns__toggle">\n                        <label for="').concat(e.sInstance,'-filter-columns-field" data-label-enable="').concat(s.customizeColumns,'" data-label-disable="').concat(s.hideCustomizeColumns,'"></label>\n                    </div>\n                    <div class="uotc-dataTables-filter-columns__fields"></div>\n                    </div>'));r.each(e.aoColumns,(function(o,r){var n=e.aoColumns[o].sTitle;i.find(".uotc-dataTables-filter-columns__fields").append(t.addColumnCheckbox(n,o,r.bVisible,a))})),r(i).insertBefore(t.$elements.stepReport),a.on("search.dt length.dt page.dt",(function(){a.columns.adjust().responsive.recalc()}))},columns:o,data:e,dom:'<"uotc-datatable-header"B>frt<"uotc-datatable-footer"lpi>',buttons:[r.extend(!0,{},u,{extend:"csv",text:n.buttons.exportCSV}),r.extend(!0,{},u,{extend:"excelHtml5",text:n.buttons.exportExcel})],language:i})}},{key:"addColumnCheckbox",value:function(e,t,o,n){var a=r("<input />",{type:"checkbox",id:"dt_"+t,value:t,checked:o});return a.on("change",(function(e){var t=r(this).attr("value"),o=r(this).is(":checked");n.columns().every((function(e){e==t&&n.column(e).visible(o)}))})),r("<label/>").append(a).append(e)}},{key:"clearTable",value:function(){try{this.table.clear().draw().columns.adjust().responsive.recalc()}catch(e){console.warn(e)}}},{key:"emptyTableMessage",value:function(){var e=uotcTopicLessonReports.i18n.emptyTable,t=e.defaults[this.type];"update-courses"===this.action?1===r("option",this.$elements.filter.courseID).length&&(t=e.course):"update-course-steps"===this.action?1===r("option",this.$elements.filter.courseStepID).length&&(t=e[this.type]):"update-table"===this.action&&(t=e.noResults),this.action="init",r(".dataTables_empty",this.$elements.stepReport).html(t)}},{key:"populateDataTable",value:function(e){this.clearTable(),this.table.rows.add(e),this.table.draw().columns.adjust().responsive.recalc(),0===e.length&&this.emptyTableMessage()}},{key:"updateCourseSelect",value:function(e,t){var o=[];for(var r in this.courseData){var n=this.courseData[r],a=n.id;e.includes(a)&&o.push({id:a,text:n.text})}var s=uotcTopicLessonReports.i18n.filters.course,i=s.default;"update-courses"===this.action&&0===o.length&&(i=s.group,this.emptyTableMessage()),this.updateSelect(this.$elements.filter.courseID,o,t,i)}},{key:"updateCourseStepSelect",value:function(e,t){var o=uotcTopicLessonReports.i18n.filters[this.type],r=o.default;"update-course-steps"===this.action&&0===e.length&&(r=o.course,this.emptyTableMessage()),this.updateSelect(this.$elements.filter.courseStepID,e,t,r)}},{key:"updateSelect",value:function(e,t,o,n){var a=e.find('option[value=""]');for(var s in n&&a.text(n),e.html(""),e.append(a),t){var i=t[s],u=i.id,l={value:u};u===o&&(l.selected="selected");var p=r("<option/>").attr(l).text(i.text);e.append(p)}}},{key:"getData",value:function(){var e=this,t={group_id:this.$elements.filter.groupID.val(),course_id:this.$elements.filter.courseID.val(),course_step_id:this.$elements.filter.courseStepID.val(),step_type:this.type,user_id:uotcTopicLessonReports.currentUser};r.ajax({method:"POST",data:t,url:uotcTopicLessonReports.root+"get_course_step_data/",beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",uotcTopicLessonReports.nonce),e.addLoaderAnimation()},success:function(t){t.course_ids&&e.updateCourseSelect(t.course_ids,t.course_id),t.step_data&&e.updateCourseStepSelect(t.step_data,t.step_id),t.course_id&&t.step_id&&t.results&&e.populateDataTable(t.results),e.removeLoaderAnimation()},fail:function(t){alert("Rest Call Failed"),console.log(t),e.removeLoaderAnimation()}})}},{key:"addLoaderAnimation",value:function(){r(this.$parent).append(uotcTopicLessonReports.loadingAnimation)}},{key:"removeLoaderAnimation",value:function(){r(".reporting-status-loading-animation-wrap",this.$parent).remove()}}],o&&t(e.prototype,o),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,o,n}(),r(document).ready((function(){if("undefined"!=typeof uotcTopicLessonReports&&null!==uotcTopicLessonReports)for(var e=["lesson","topic"],t=0;t<e.length;t++){var o=e[t],a=r(".uotc-"+o+"-report");if(a.length>0)for(var s=0;s<a.length;s++)uotcTopicLessonReports[o+"Report"]=new n(a[s],o)}}))})(),(()=>{if(void 0===e)var e={};!function(t){function o(e){for(var t=0,o=(e=e.split(" ")).length;t<o;t++)void 0!==e[t][0]&&(e[t]=e[t][0].toUpperCase()+e[t].substr(1));return e.join(" ")}t(document).ready((function(){t("#uotc-group-report-table").length&&e.courseReport.constructor(),t("#uo-quiz-report-table").length&&e.quizReport.constructor()})),e.courseReport={uoTable:null,uoHiddenTable:null,courseId:0,constructor:function(){this.setTableDefaults(),this.createTable(),this.createHiddenTable(),this.addEvents()},createHiddenTable:function(e){var r={bFilter:!1,aLengthMenu:[[15,30,60,-1],[15,30,60,"All"]],iDisplayLength:30,columns:[{width:"20%",data:"user_name"},{width:"20%",data:"quiz_name"},{width:"20%",data:"quiz_score"},{width:"20%",data:"quiz_date",render:{_:"display",sort:"timestamp"}}],data:e},n=(s=new Date).getDate(),a=s.getMonth()+1;n<10&&(n="0"+n),a<10&&(a="0"+a);var s=n+"-"+a+"-"+s.getFullYear(),i=t("#uo-group-report-group option:selected").text();""===i&&(i=t("#uo-group-report-selections").text());var u=t("#uo-group-report-courses option:selected").text(),l=o(i=i.replace(/^\s+|\s+$/gm,"")).replace(/\s+/g,"")+" "+o(u).replace(/\s+/g,"")+" "+s;r.dom="Bfrtip",r.buttons=[{extend:"csvHtml5",title:o(i)+" - "+o(u)+" On "+s,filename:l},{extend:"pdfHtml5",title:o(i)+" - "+o(u)+" On "+s,filename:l}],r.language={emptyTable:groupLeaderCourseReportSetup.i18n.emptyTable,info:groupLeaderCourseReportSetup.i18n.info,infoEmpty:groupLeaderCourseReportSetup.i18n.infoEmpty,infoFiltered:groupLeaderCourseReportSetup.i18n.infoFiltered,lengthMenu:groupLeaderCourseReportSetup.i18n.lengthMenu,loadingRecords:groupLeaderCourseReportSetup.i18n.loadingRecords,processing:groupLeaderCourseReportSetup.i18n.processing,search:"",searchPlaceholder:groupLeaderCourseReportSetup.i18n.searchPlaceholder,zeroRecords:groupLeaderCourseReportSetup.i18n.zeroRecords,paginate:{first:groupLeaderCourseReportSetup.i18n.paginate.first,last:groupLeaderCourseReportSetup.i18n.paginate.last,next:groupLeaderCourseReportSetup.i18n.paginate.next,previous:groupLeaderCourseReportSetup.i18n.paginate.previous},aria:{sortAscending:groupLeaderCourseReportSetup.i18n.sortAscending,sortDescending:groupLeaderCourseReportSetup.i18n.sortDescending}},this.uoHiddenTable&&this.uoHiddenTable.destroy(),this.uoHiddenTable=jQuery("#uotc-group-report-table--hidden").DataTable(r)},createTable:function(e){var o=!1;""!==sfwd_data.userReportUrl&&(o=[],t.each(e,(function(e,t){console.log(t);var r=t;r.user_name='<a href="'+sfwd_data.userReportUrl+"?user_id="+t.user_id+'">'+t.user_name+"</a>",o.push(r)}))),console.log(o);var r={bFilter:!0,aLengthMenu:[[15,30,60,-1],[15,30,60,"All"]],iDisplayLength:30,columns:[{width:"20%",data:"user_name"},{width:"20%",data:"quiz_name"},{width:"20%",data:"quiz_score"},{width:"20%",orderable:!1,searchable:!1,data:"quiz_modal",defaultContent:""},{width:"20%",data:"quiz_date",render:{_:"display",sort:"timestamp"}}],columnDefs:[{targets:2,orderable:!1,searchable:!1}],data:e,language:{emptyTable:groupLeaderCourseReportSetup.i18n.emptyTable,info:groupLeaderCourseReportSetup.i18n.info,infoEmpty:groupLeaderCourseReportSetup.i18n.infoEmpty,infoFiltered:groupLeaderCourseReportSetup.i18n.infoFiltered,lengthMenu:groupLeaderCourseReportSetup.i18n.lengthMenu,loadingRecords:groupLeaderCourseReportSetup.i18n.loadingRecords,processing:groupLeaderCourseReportSetup.i18n.processing,search:"",searchPlaceholder:groupLeaderCourseReportSetup.i18n.searchPlaceholder,zeroRecords:groupLeaderCourseReportSetup.i18n.zeroRecords,paginate:{first:groupLeaderCourseReportSetup.i18n.paginate.first,last:groupLeaderCourseReportSetup.i18n.paginate.last,next:groupLeaderCourseReportSetup.i18n.paginate.next,previous:groupLeaderCourseReportSetup.i18n.paginate.previous},aria:{sortAscending:groupLeaderCourseReportSetup.i18n.sortAscending,sortDescending:groupLeaderCourseReportSetup.i18n.sortDescending}}};this.uoTable&&this.uoTable.destroy(),this.uoTable=jQuery("#uotc-group-report-table").DataTable(r)},addEvents:function(){t("#uo-group-report-group").on("change",(function(){var o=t(this).val();e.reporting.groupId=o,e.reporting.isNormalInteger(o)&&e.reporting.getGroupCourses(parseInt(o))})),t("#uo-group-report-courses").on("change",(function(){var o=t(this).val(),r=t("#uo-group-report-selections").data("group-id");void 0===r&&(r=t("#uo-group-report-group").val()),e.reporting.isNormalInteger(o)&&e.courseReport.getUserCourseData(parseInt(o),parseInt(r))})),t(".uotc-report__btn.uotc-report__btn--csv").on("click",(function(){t("#uotc-group-report-container--hidden .buttons-csv").click()})),t(".uotc-report__btn.uotc-report__btn--pdf").on("click",(function(){t("#uotc-group-report-container--hidden .buttons-pdf").click()}))},getUserCourseData:function(o,r){var n={groupId:r,courseId:o};t.ajax({method:"POST",data:n,url:groupLeaderCourseReportSetup.root+"get_user_course_data/",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",groupLeaderCourseReportSetup.nonce)},success:function(t){e.courseReport.createTable(t.data),e.courseReport.createHiddenTable(t.data)},fail:function(e){alert("Rest Call Failed"),console.log(e)}})},setTableDefaults:function(){jQuery.extend(jQuery.fn.dataTable.defaults,{searching:!1,ordering:!0,paging:!0,responsive:!0})}},e.quizReport={uoTable:null,uoTableHidden:null,userId:0,groupId:0,courseId:0,constructor:function(){this.createTable(),this.createTableHidden(),this.addEvents()},createTable:function(e){var o={aLengthMenu:[[15,30,60,-1],[15,30,60,"All"]],iDisplayLength:30,columnDefs:[{targets:3,orderable:!1,searchable:!1}]};null!==this.uoTable&&(this.uoTable.destroy(),o.data=e.quizzes,o.columns=[{data:"course_name"},{data:"quiz_name"},{data:"quiz_score"},{orderable:!1,searchable:!1,data:"quiz_modal",defaultContent:""},{data:"quiz_date",render:{_:"display",sort:"timestamp"}}]),o.language={emptyTable:groupLeaderCourseReportSetup.i18n.emptyTable,info:groupLeaderCourseReportSetup.i18n.info,infoEmpty:groupLeaderCourseReportSetup.i18n.infoEmpty,infoFiltered:groupLeaderCourseReportSetup.i18n.infoFiltered,lengthMenu:groupLeaderCourseReportSetup.i18n.lengthMenu,loadingRecords:groupLeaderCourseReportSetup.i18n.loadingRecords,processing:groupLeaderCourseReportSetup.i18n.processing,search:"",searchPlaceholder:groupLeaderCourseReportSetup.i18n.searchPlaceholder,zeroRecords:groupLeaderCourseReportSetup.i18n.zeroRecords,paginate:{first:groupLeaderCourseReportSetup.i18n.paginate.first,last:groupLeaderCourseReportSetup.i18n.paginate.last,next:groupLeaderCourseReportSetup.i18n.paginate.next,previous:groupLeaderCourseReportSetup.i18n.paginate.previous},aria:{sortAscending:groupLeaderCourseReportSetup.i18n.sortAscending,sortDescending:groupLeaderCourseReportSetup.i18n.sortDescending}},this.uoTable=jQuery("#uo-quiz-report-table").DataTable(o),t(".uotc-report__btn.uotc-report__btn--csv").on("click",(function(){t("#uotc-user-report-container--hidden .buttons-csv").click()})),t(".uotc-report__btn.uotc-report__btn--pdf").on("click",(function(){t("#uotc-user-report-container--hidden .buttons-pdf").click()}))},createTableHidden:function(e){var t=(r=new Date).getDate(),o=r.getMonth()+1;t<10&&(t="0"+t),o<10&&(o="0"+o);var r=t+"-"+o+"-"+r.getFullYear(),n=JSON.parse(sfwd_data.json).user_name+" - "+r,a={iDisplayLength:-1,dom:"Bfrtip",buttons:[{extend:"csvHtml5",title:n},{extend:"pdfHtml5",title:n}]};null!==this.uoTableHidden&&(this.uoTableHidden.destroy(),a.data=e.quizzes),a.language={emptyTable:groupLeaderCourseReportSetup.i18n.emptyTable,info:groupLeaderCourseReportSetup.i18n.info,infoEmpty:groupLeaderCourseReportSetup.i18n.infoEmpty,infoFiltered:groupLeaderCourseReportSetup.i18n.infoFiltered,lengthMenu:groupLeaderCourseReportSetup.i18n.lengthMenu,loadingRecords:groupLeaderCourseReportSetup.i18n.loadingRecords,processing:groupLeaderCourseReportSetup.i18n.processing,search:"",searchPlaceholder:groupLeaderCourseReportSetup.i18n.searchPlaceholder,zeroRecords:groupLeaderCourseReportSetup.i18n.zeroRecords,paginate:{first:groupLeaderCourseReportSetup.i18n.paginate.first,last:groupLeaderCourseReportSetup.i18n.paginate.last,next:groupLeaderCourseReportSetup.i18n.paginate.next,previous:groupLeaderCourseReportSetup.i18n.paginate.previous},aria:{sortAscending:groupLeaderCourseReportSetup.i18n.sortAscending,sortDescending:groupLeaderCourseReportSetup.i18n.sortDescending}},this.uoTableHidden=jQuery("#uo-quiz-report-table-hidden").DataTable(a)},flattenArray:function(e,t){var o=[];return jQuery.each(e,(function(e,t){jQuery.each(t.question,(function(e,r){o.push({quiz_name:t.quiz_name,quiz_score:t.quiz_score,answer:t.answer[e],question:t.question[e]})}))})),o},addEvents:function(){t("#uo-group-report-group").on("change",(function(){var o=t(this).val();e.reporting.groupId=o,t("#uo-group-report-user option:first-child").attr("selected","selected"),t("#uo-group-report-course option:first-child").attr("selected","selected"),e.reporting.isNormalInteger(o)&&e.reporting.getGroupCourses(parseInt(o))})),t("#uo-group-report-user").on("change",(function(){var o=t(this).val();e.quizReport.userId=o;var r=t("#uo-group-report-course").val();e.quizReport.courseId=r,e.quizReport.getUserQuizData(r,o)})),t("#uo-group-report-course").on("change",(function(){if(t("#uo-group-report-user option:first-child").attr("selected","selected"),t(this).hasClass("learner")){var o=t(this).data("user-id");e.quizReport.userId=o;var r=t(this).val();e.quizReport.courseId=r,e.quizReport.getUserQuizData(r,o)}else console.log("leader")})),t("#uo-quiz-report-table").on("click","td.details-control",(function(){var o=t(this).closest("tr"),r=e.quizReport.uoTable.row(o);r.child.isShown()?(r.child.hide(),o.removeClass("shown")):(r.child(e.quizReport.format(r.data())).show(),o.addClass("shown"))}))},format:function(e){var o="";return t.each(e.answer,(function(t,r){o+="<tr><td>"+e.question[t]+"</td><td>"+r+"</td></tr>"})),'<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">'+o+"</table>"},getGroupUsers:function(o,r){var n={groupUserIds:o,courseId:r};t.ajax({method:"POST",data:n,url:groupLeaderCourseReportSetup.root+"get_groups_user_quiz_data/",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",groupLeaderCourseReportSetup.nonce)},success:function(t){e.quizReport.createTable(t),e.quizReport.createTableHidden(t)},fail:function(e){alert("Rest Call Failed")}})},getUserQuizData:function(o,r){if(e.reporting.isNormalInteger(o)||t("#uo-group-report-course").addClass("missing"),!e.reporting.isNormalInteger(o))return!1;if(!e.reporting.isNormalInteger(String(r)))return!1;t("#uo-group-report-course").removeClass("missing");var n={userId:e.quizReport.userId,courseId:e.quizReport.courseId};t.ajax({method:"POST",data:n,url:groupLeaderCourseReportSetup.root+"get_user_quiz_data/",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",groupLeaderCourseReportSetup.nonce)},success:function(t){e.quizReport.createTable(t),e.quizReport.createTableHidden(t)},fail:function(e){alert("Rest Call Failed"),console.log(e)}})}},e.reporting={getGroupCourses:function(e){"undfined"!=typeof sfwd_data&&"undefined"!==sfwd_data.groupCourses&&"undefined"!==sfwd_data.groupCourses[e]?this.createCourseDropDown(sfwd_data.groupCourses[e]):this.createCourseDropDown([])},createCourseDropDown:function(e){var o=t("#uo-group-report-courses"),r='<option value="0">'+groupLeaderCourseReportSetup.i18n.selectCourseDropdownPlaceholder+"</option>";if(0===e.length)return o.html('<option value="0">'+groupLeaderCourseReportSetup.i18n.selectCourseDropdownNoCourses+"</option>"),!0;t.each(e,(function(e,t){var o=parseInt(t);"undfined"!=typeof sfwd_data&&"undefined"!==sfwd_data.courses&&"undefined"!==sfwd_data.courses[o]&&(r+='<option value="'+sfwd_data.courses[o].ID+'">'+sfwd_data.courses[o].post_title+"</option>")})),o.html(r),o.show()},createUserDropDown:function(e){var o=t("#uo-group-report-user"),r='<option value="0">'+groupLeaderCourseReportSetup.i18n.selectStudentDropdownPlaceholder+"</option>";if(0===e.length)return o.html('<option value="0">'+groupLeaderCourseReportSetup.i18n.selectStudentDropdownNoStudents+"</option>"),!0;t.each(e,(function(e,t){var o=t.display_name;void 0===t.first_name&&void 0===t.last_name||""===t.first_name&&""===t.last_name||(o=t.first_name+" "+t.last_name),r+='<option value="'+t.id+'">'+o+"</option>"})),o.html(r),o.show()},isNormalInteger:function(e){var t=~~Number(e);return String(t)===e&&t>0},getQueryVariable:function(e){for(var t=window.location.search.substring(1).split("&"),o=0;o<t.length;o++){var r=t[o].split("=");if(r[0]==e)return r[1]}return!1}}}(jQuery)})(),(()=>{if(void 0===e)var e={};var t;(t=jQuery)(document).ready((function(){t("#uotc-question-report").length&&e.questionAnalysisReport.constructor(),console.log(t("#uotc-question-report-selections")),t("#uotc-question-report-selections").length&&e.questionAnalysisFilters.init()})),e.questionAnalysisReport={uoTable:null,constructor:function(){this.createTable()},createTable:function(e){var o={filename:function(){var e=[document.title];return["uotc-question-report-group"].forEach((function(t){var o=document.getElementById(t);try{if(o){var r=o.value;""!==r&&"0"!=r&&e.push(o.querySelector('option[value="'.concat(r,'"]')).innerText.trim())}}catch(e){}})),e.join(" - ")}},r={dom:'<"reporting-datatable"<"reporting-datatable__top"<"reporting-datatable__search"f><"reporting-datatable-top__middle"><"reporting-datatable__buttons"B>><"reporting-datatable__table"t><"reporting-datatable__bottom"<"reporting-datatable__bottom-left"<"reporting-datatable__bottom-left-info"i><"reporting-datatable__bottom-left-info"l>><"reporting-datatable__bottom-right"p><"reporting-datatable__bottom-notice">>>',aLengthMenu:[[15,30,60,-1],[15,30,60,"All"]],order:[],iDisplayLength:30,responsive:!0,searching:!0,columnDefs:[{targets:[3,4,6,7],orderable:!0},{targets:"_all",orderable:!1,searchable:!0}],buttons:[t.extend(!0,{},o,{extend:"csv",text:"CSV"}),t.extend(!0,{},o,{extend:"excelHtml5",text:"Excel"})]};null!==this.uoTable&&this.uoTable.destroy(),r.language={emptyTable:uoQuestionAnalysisReportSetup.i18n.emptyTable,info:uoQuestionAnalysisReportSetup.i18n.info,infoEmpty:uoQuestionAnalysisReportSetup.i18n.infoEmpty,infoFiltered:uoQuestionAnalysisReportSetup.i18n.infoFiltered,lengthMenu:uoQuestionAnalysisReportSetup.i18n.lengthMenu,loadingRecords:uoQuestionAnalysisReportSetup.i18n.loadingRecords,processing:uoQuestionAnalysisReportSetup.i18n.processing,search:"",searchPlaceholder:uoQuestionAnalysisReportSetup.i18n.searchPlaceholder,zeroRecords:uoQuestionAnalysisReportSetup.i18n.zeroRecords,paginate:{first:uoQuestionAnalysisReportSetup.i18n.paginate.first,last:uoQuestionAnalysisReportSetup.i18n.paginate.last,next:uoQuestionAnalysisReportSetup.i18n.paginate.next,previous:uoQuestionAnalysisReportSetup.i18n.paginate.previous},aria:{sortAscending:uoQuestionAnalysisReportSetup.i18n.sortAscending,sortDescending:uoQuestionAnalysisReportSetup.i18n.sortDescending}},this.uoTable=jQuery("#uotc-question-report").DataTable(r),t(".uotc-question-report__btn.uotc-question-report__btn--csv").on("click",(function(){t("#uotc-user-report-container--hidden .buttons-csv").click()})),t(".uotc-question-report__btn.uotc-question-report__btn--pdf").on("click",(function(){t("#uotc-user-report-container--hidden .buttons-pdf").click()}))}},e.questionAnalysisFilters={init:function(){this.loadingOnSubmit(),this.select2Dropdowns()},loadingOnSubmit:function(){var e=this,t=this.getForm().find("select");this.getForm().on("submit",(function(){e.getForm().addClass("uotc-question-report-selections-form--loading"),t.prop("readonly",!0)}))},select2Dropdowns:function(){this.getForm().find("select").each((function(e,o){try{var r=t(o),n={},a=r.data("placeholder");a&&(n.placeholder=a),r.select2(n)}catch(e){console.log(e)}}))},getForm:function(){return t("#uotc-question-report-selections > form")}}})();
//# sourceMappingURL=tincanny-reports.min.js.map